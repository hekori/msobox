C        Generated by TAPENADE     (INRIA, Tropics team)
C  Tapenade 3.6 (r4343) - 10 Feb 2012 10:52
C
C  Differentiation of ffcn in reverse (adjoint) mode:
C   gradient     of useful results: f p u x
C   with respect to varying inputs: p u x
C   RW status of diff variables: f:in-killed p:incr u:incr x:incr
C ===============================================================================
C
C fortran ffcn for the chemical reaction example
C
C 	x1_dot = - u * x1 + u ** 2 * x2
C 	x2_dot = u * x1 - p * u ** 2 * x2
C   
C 	0 < u < 1 
C 
C ===============================================================================
C
      SUBROUTINE FFCN_B_XPU(t, x, x_b, f, f_b, p, p_b, u, u_b)
      IMPLICIT NONE
C
C
      DOUBLE PRECISION x(2), f(2), p(1), u(1), t
      DOUBLE PRECISION x_b(2), f_b(2), p_b(1), u_b(1)
      DOUBLE PRECISION temp_b
C
      f(1) = -(u(1)*x(1)) + u(1)**2*x(2)
      f(2) = u(1)*x(1) - p(1)*u(1)**2*x(2)
      temp_b = -(u(1)**2*f_b(2))
      u_b(1) = u_b(1) + (x(1)-p(1)*x(2)*2*u(1))*f_b(2)
      x_b(1) = x_b(1) + u(1)*f_b(2)
      p_b(1) = p_b(1) + x(2)*temp_b
      f_b(2) = 0.D0
      x_b(2) = x_b(2) + u(1)**2*f_b(1) + p(1)*temp_b
      u_b(1) = u_b(1) + (x(2)*2*u(1)-x(1))*f_b(1)
      x_b(1) = x_b(1) - u(1)*f_b(1)
      END
C
C ===============================================================================

